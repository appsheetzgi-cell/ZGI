<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Status Produksi</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    padding: 20px;
  }

  h1 {
    text-align: center;
    margin-bottom: 30px;
  }

  .section {
    margin-bottom: 40px;
  }

  .section-title {
    background: #d9ecf7;
    display: inline-block;
    padding: 6px 14px;
    font-weight: bold;
    margin-bottom: 10px;
    border-radius: 4px;
  }

  table {
    border-collapse: collapse;
    width: 100%;
    background: #fff;
  }

  th, td {
    border: 1px solid #000;
    padding: 6px;
    text-align: center;
    font-size: 14px;
  }

  th {
    background: #e6f2fb;
  }

  .negative {
    color: red;
    font-weight: bold;
  }

  .status-not {
    background: red;
    color: #fff;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>STATUS PRODUKSI</h1>

<div id="content"></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0nVNWtyTP5CJkOFoC5Ga31U-NroZ-7EsjHQL_TuzkpjXUso7hEWA6NWpYQeydSGshWd4vJCgOeTZG/pub?gid=1353631758&single=true&output=csv";

fetch(CSV_URL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.trim().split("\n").map(r => r.split(","));
    const header = rows.shift();

    const sections = {
      "Foam_Packing": [],
      "Topper": [],
      "Spring_Packing": []
    };

    rows.forEach(row => {
      const kategori = row[0];
      if (sections[kategori]) {
        sections[kategori].push(row.slice(1));
      }
    });

    const container = document.getElementById("content");

    Object.keys(sections).forEach(kategori => {
      const section = document.createElement("div");
      section.className = "section";

      section.innerHTML = `
        <div class="section-title">${kategori}</div>
        <table>
          <thead>
            <tr>
              <th>Week</th>
              <th>Qty Order</th>
              <th>Qty Produksi</th>
              <th>Balance</th>
              <th>Persentase</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            ${sections[kategori].map(r => `
              <tr>
                <td>${r[0]}</td>
                <td>${r[1]}</td>
                <td>${r[2]}</td>
                <td class="negative">${r[3]}</td>
                <td>${r[4]}</td>
                <td class="status-not">${r[5]}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `;

      container.appendChild(section);
    });
  });
</script>

</body>
</html>
