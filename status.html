<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Status Produksi</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  padding: 20px;
}
h1 {
  text-align: center;
}
.section {
  margin-bottom: 40px;
}
.section-title {
  background: #d9ecf7;
  padding: 6px 14px;
  display: inline-block;
  font-weight: bold;
  margin-bottom: 10px;
}
table {
  border-collapse: collapse;
  width: 100%;
  background: white;
}
th, td {
  border: 1px solid #000;
  padding: 6px;
  text-align: center;
}
th {
  background: #e6f2fb;
}
.negative {
  color: red;
  font-weight: bold;
}
.status-not {
  background: red;
  color: white;
  font-weight: bold;
}
.balance-negative {
  color: red;
  font-weight: bold;
}

.status-not {
  background: red;
  color: white;
  font-weight: bold;
}
  
</style>
</head>
<body>

<h1>STATUS PRODUKSI</h1>

<div id="app"></div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0nVNWtyTP5CJkOFoC5Ga31U-NroZ-7EsjHQL_TuzkpjXUso7hEWA6NWpYQeydSGshWd4vJCgOeTZG/pub?gid=1353631758&single=true&output=csv";

fetch(CSV_URL)
  .then(r => r.text())
  .then(csv => {
    const rows = csv.trim().split("\n").map(r => r.split(","));

    // ðŸ”§ ATUR BARIS SESUAI SHEET ANDA
    const foamRows   = rows.slice(6, 11);
    const topperRows = rows.slice(14, 19);
    const springRows = rows.slice(22, 27);

    const app = document.getElementById("app");

    function render(title, data) {
      app.innerHTML += `
        <div class="section">
          <div class="section-title">${title}</div>
          <table>
            <thead>
              <tr>
                <th>Week</th>
                <th>Qty Order</th>
                <th>Qty Produksi</th>
                <th>Balance</th>
                <th>Persentase</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${data.map(r => `
                <tr>
                  <td>${r[1]}</td>
                  <td>${r[2]}</td>
                  <td>${r[3]}</td>
                  <td class="${Number(r[4]) < 0 ? 'balance-negative' : ''}">
                   ${r[4]}
                   </td>
                  <td>${r[5]}</td>
                  <td class="${r[6].toString().toLowerCase().includes('not') ? 'status-not' : ''}">
                  ${r[6]}
                   </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
      `;
    }

    render("Foam_Packing", foamRows);
    render("Topper", topperRows);
    render("Spring_Packing", springRows);
  });
</script>

</body>
</html>
